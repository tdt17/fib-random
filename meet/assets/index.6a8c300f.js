import{r as b,w as h,i as O,d as $,c as g,H as I,a as S,j,z as A,n as C,b as m,o as c,e as l,f as x,v as L,u as d,g as u,t as f,F as v,h as D,k as p,l as E,m as F,p as V,q as z,s as B,x as M,y as U}from"./vendor.5ca93c9f.js";const J=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const y of o.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&i(y)}).observe(document,{childList:!0,subtree:!0});function a(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(s){if(s.ep)return;s.ep=!0;const o=a(s);fetch(s.href,o)}};J();const k="fib-config",r=b({name:""});Object.assign(r,JSON.parse(localStorage.getItem(k)||"{}"));h(r,e=>{localStorage.setItem(k,JSON.stringify(e))});O({apiKey:"AIzaSyDlAUfPJ6T-xQMJcsbAT3SW7zFSFxDQZh4",authDomain:"fib-random.firebaseapp.com",projectId:"fib-random",storageBucket:"fib-random.appspot.com",messagingSenderId:"724579742971",appId:"1:724579742971:web:7b8e2259a4d585b9be6c5e"});const w=$(),T=async()=>{const e={users:{},settings:{admin:r.name,options:["1","2","3","5"]}};return(await A(C(w,"sessions"),e)).id},n=b({loading:!0,id:window.location.hash.slice(1),active:!1,state:void 0}),K=g(()=>{var e,t;return Object.keys((t=(e=n.state)==null?void 0:e.users)!=null?t:{}).sort()}),P=g(()=>{var e,t;return Object.values((t=(e=n.state)==null?void 0:e.users)!=null?t:{}).every(({ready:a})=>a)});let _;h(()=>[n.id,r.name],([e,t])=>{if(!t||!e){n.loading=!1;return}_==null||_(),_=I(S(w,`sessions/${e}`),a=>{n.active=a.exists(),n.state=a.data(),n.loading=!1})},{immediate:!0});const N=async(e,t)=>{await j(S(w,`sessions/${n.id}`),{users:{[e]:t}},{merge:!0})};h(()=>{var e;return[(e=n.state)==null?void 0:e.users,r.name]},([e,t])=>{!e||typeof e=="string"||!t||typeof t!="string"||e[t]||N(t,{ready:!1,estimate:~~(Math.random()*100)})});window.addEventListener("hashchange",()=>{n.id=window.location.hash.slice(1)});Object.assign(window,{session:n});const R=m({setup(e){const t=async()=>{const a=await T();window.location.hash=a};return(a,i)=>(c(),l(v,null,[x(u("div",null,'Session "'+f(d(n).id)+'" not found',513),[[L,d(n).id]]),u("button",{onClick:t},"New Session")],64))}});const q={class:"user"},G=p("Ready: "),H={key:0,class:"value"},Q={key:1,class:"value"},W={key:0},Y=p("Estimate: "),Z={class:"value"},X=m({props:{name:null,user:null},setup(e){const t=e,a=()=>{N(r.name,{ready:!t.user.ready})};return(i,s)=>(c(),l("div",q,[u("h3",null,f(e.name),1),u("div",null,[G,e.name===d(r).name?(c(),l("span",H,[u("button",{onClick:a},f(e.user.ready),1)])):(c(),l("span",Q,f(e.user.ready),1))]),d(P)?(c(),l("div",W,[Y,u("span",Z,f(e.user.estimate),1)])):D("",!0)]))}});const ee={class:"users"},te=m({setup(e){return(t,a)=>(c(!0),l(v,null,E(d(K),i=>{var s;return c(),l("div",ee,[F(X,{name:i,user:(s=d(n).state)==null?void 0:s.users[i]},null,8,["name","user"])])}),256))}}),se=p(" Enter your name: "),ne=p(),ae=m({setup(e){const t=V(r.name),a=()=>{r.name=t.value};return(i,s)=>(c(),l(v,null,[se,x(u("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>t.value=o)},null,512),[[z,t.value]]),ne,u("button",{onClick:a},"Go")],64))}});const oe=m({setup(e){const t=g(()=>r.name?n.loading?null:n.active?te:R:ae);return(a,i)=>(c(),B(M(d(t))))}});U(oe).mount("#app");
